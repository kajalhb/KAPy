import xarray as xr
import numpy as np
import matplotlib.pyplot as plt

# ds = xr.open_dataset("../results/2.indicators_time_binning_periods/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2040.nc")
# ds = xr.open_dataset("/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2040.nc")
# ds = xr.open_dataset("/lustre/storeC-ext/users/kin2100/MET/3DBC/application/cnrm-r1i1p1-aladin/pr/rcp26/cnrm-r1i1p1-aladin_rcp26_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2040.nc4")
# ds = xr.open_dataset("/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/1.variables/pr/pr_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2040.nc")
# files = ["/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2040.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2041.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2042.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2043.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2044.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2045.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2046.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2047.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2048.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2049.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2050.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2051.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2052.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2053.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2054.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2055.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2056.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2057.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2058.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2059.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2060.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2061.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2062.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2063.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2064.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2065.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2066.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2067.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2068.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2069.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2070.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2071.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2072.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2073.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2074.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2075.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2076.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2077.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2078.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/2.indicators_time_binning_periods_oslo/102/102_CMIP5_rcp26_cnrm-r1i1p1-aladin_3dbc-eqm-sn2018v2005_rawbc_norway_1km_pr_daily_2079.nc"]
# files = ["/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/4.ensstats/time_binning_periods/hadgem/102_CMIP5_rcp26_ensstats.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/4.ensstats/time_binning_periods/hadgem/102_CMIP5_rcp45_ensstats.nc"]
files = ["/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/7.netcdf/102_rcp26_change_periods.nc", "/lustre/storeC-ext/users/klimakverna/development/Klimakverna-pilot-KAPy/KAPy/results/7.netcdf/102_rcp45_change_periods.nc"]

for filename in files:
    ds = xr.open_dataset(filename)
    print(ds)
    # ds["indicator_mean"].isel(periodID=1).plot()
    # plt.show()
    # try:
    #     print(ds["indicator_mean"].values)
    #     print(ds["periodID"].values)
    #     print(f"\n\n{ds["indicator_mean"].values[0, 550, 800]}")
    #     print(f"\n\n{ds["indicator_mean"].values[1, 550, 800]}")
    #     print(f"\n\n{ds["indicator_mean"].values[2, 550, 800]}")
    #     # print(ds["indicator_mean"]["2"])
    #     # print(ds["indicator_mean"]["3"])
    # except KeyError:
    #    raise KeyError

# multi_ds = xr.open_mfdataset(period_files, concat_dim="realization", combine="nested")
# print(multi_ds)

# print(np.min(ds["lon"]))
# print(np.max(ds["lon"]))
# print(np.min(ds["lat"]))
# print(np.max(ds["lat"]))
# ds_cut = ds.sel(lon=slice(4.088, 31.761))
# ds_cut = ds.loc[dict(lon=slice(4.088, 31.761))]
#
# ds_cut = ds.where(ds.lon.all() <=31.761)
# ds_cut = ds_cut.where(4.088 <= ds_cut.lon.all())
# print(np.min(ds_cut["lon"]))
# print(np.max(ds_cut["lon"]))
# print(np.min(ds_cut["lat"]))
# print(np.max(ds_cut["lat"]))